from selenium import webdriver
from selenium.webdriver.common.keys import Keys
from selenium.webdriver.chrome.service import Service
from selenium.webdriver.common.by import By
from selenium.webdriver.support.ui import WebDriverWait
from selenium.webdriver.support import expected_conditions as EC
from selenium.webdriver.common.action_chains import ActionChains
import time

driver = webdriver.Chrome()
browser = driver.get("https://finance.yahoo.com/quote/BTC-USD/history?period1=1410912000&period2=1640131200&interval=1d&filter=history&frequency=1d&includeAdjustedClose=true")
for i in range(0,500):
    driver.execute_script("window.scrollBy(0,350)")
time.sleep(2)

elements = driver.find_elements(By.TAG_NAME, 'tr')
lines = []
for line in elements:
    lines.append(line.text)
    
ColumnName = []
Dates1 = []
Open1 = []
High1 = []
Low1 = []
Close1 = []
AdjClose1 = []
Volume1 = []
for i in range(0,8):
    ColumnName.append(lines[0].rsplit(' ')[i])
ColumnName[5] = ColumnName[5] + ColumnName[6]
ColumnName.pop(6)

tmp = 1
for i in range(1, len(lines)):
    Dates1.append(lines[tmp][:12])
    Open1.append(lines[tmp].rsplit(' ')[3])
    High1.append(lines[tmp].rsplit(' ')[4])
    Low1.append(lines[tmp].rsplit(' ')[5])
    Close1.append(lines[tmp].rsplit(' ')[6])
    AdjClose1.append(lines[tmp].rsplit(' ')[7])
    Volume1.append(lines[tmp].rsplit(' ')[8])
    tmp += 1
